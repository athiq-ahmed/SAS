PROC APPEND BASE=DSN1 DATA=DSN2;
RUN;

DATA MASTER;
INPUT CITY $ MONTH$ TEMP;
CARDS;
DIL JAN 2.2
MUM JAN 3.5
KOL JAN 4.2
CHN JAN 6.4
;
RUN;

DATA ADD1;
INPUT CITY $ MONTH $ TEMP;
CARDS;
BLR JAN 9.6
HYD JAN 10.2
;
RUN;


DATA ADD2;
INPUT CITY $ MONTH $ RAINFALL TEMP;
CARDS;
BLR FEB 46 9.6
HYD FEB 56 10.2
;
RUN;

PROC APPEND BASE=MASTER DATA=ADD1;
RUN;
PROC PRINT DATA=MASTER;
RUN;


PROC APPEND BASE=MASTER DATA=ADD2 FORCE;
RUN;
PROC PRINT DATA=MASTER;
RUN;

/*SET -> IT USED TO CONCATENATE DATA SETS.*/

DATA PART1;
INPUT ID NAME$;
CARDS;
101 SACHIN
105 LATA
103 SAINA
107 RAINA
;
RUN;

DATA PART2;
INPUT ID AGE SEX$;
CARDS;
102 28 M
105 29 F
107 30 M
109 29 F
103 31 F
;
RUN;
one to one reading;
data new;
set part1;
set part2;
run;
proc print;
run;
concatenating;
data new_1;
set part1 part2;
run;
proc print;
run;
DATA COMBINE1;
SET PART1 PART2;
RUN;

PROC PRINT;
RUN;

/*INTERLEAVING*/

PROC SORT DATA=PART1;
BY ID;
PROC SORT DATA=PART2;
BY ID;
RUN;

DATA CONBINE2;
SET PART1 PART2;
BY ID;
RUN;
PROC PRINT;
RUN;

/*MERGE -> COMBINING TWO OR MORE DATA SET ( OBSEVATION BY OBSERVATION)*/

/*REQUIRED PRE SORTING OF ALL DATA SET ACCORDING TO COMMON VARIABLE OR BY STMT VARIABLE*/
DATA MIX1;
MERGE PART1 PART2;
BY ID; /* DON'T TRY MERGE WITHOUT BY */
RUN;
PROC PRINT;
RUN;
data work.donors1;
input id type$ units;
cards;
2304 O 16
1129 A  48
1129 A 50
1129 A 57
2486 B 63
;
run;
data work.donors2;
input id code units;
cards;
6488 65 27
1129 63 32
5438 62 39
2304 61 45
1387 64 67
;
run;
proc sort data = work.donors1;
by id;
run;
proc sort data = work.donors2;
by id;
run;
data work.merged; 
merge work.donors1 work.donors2; 
by id; 
run;
proc print;
run;
DATA MIX2;
MERGE PART1(IN=A) PART2(IN=B);
BY ID;
PUT ID= A= B= NAME= AGE= SEX= ;
RUN;
PROC PRINT;
RUN;
/*
TWO JOINS -

INNER JOINS - COMMON OBSERVATIONS
OUTER JOINS	 - 1. LEFT JOIN  2. RIGHT JOINS
LEFT JOINS - INNER JOIN+ ALL THE OBSERVATION OF LEFT HAND SIDE DATASET
RIGHT JOINS - INNER JOIN+ ALL THE OBSERVATION OF RIGHT HAND SIDE DATASET
*/

DATA INNER_JOIN;
MERGE PART1(IN=A) PART2(IN=B);
BY ID;
/*IF A=B=1;*/
/*if a = 1 and b =1;*/
if a = 1 or b =1;
RUN;
PROC PRINT;
RUN;

DATA LEFT_JOIN;
MERGE PART1(IN=A) PART2(IN=B);
BY ID;
IF A=1;
RUN;
PROC PRINT;
RUN;


DATA RIGHT_JOIN;
MERGE PART1(IN=A) PART2(IN=B);
BY ID;
IF B=1;
RUN;
PROC PRINT;
RUN;
/*
TYPE OF MERGE -
ONE TO ONE  - IN BOTH THE DATA SET WE SHOULD HAVE ONE OBSERVATION FOR EACH 
			  UNIQUE VALUE OF COMMON VARIABLE
ONE TO MANY - IN ONE OF THE DATA SET WE SHOULD HAVE MORE THAN ONE OBSERVATION 
			  FOR EACH UNIQUE VALUE OF COMMON VARIABLE
MANY TO MANY - IN BOTH THE DATASET WE SHOULD HAVE EQUAL NUMBER OF OBSERVATION 
				FOR EACH UNIQUE VALUE OF COMMON VARIABLE

*/

DATA ONE;
INPUT X Y$;
CARDS;
101 AA
102 BB
103 CC
;
RUN;
DATA TWO;
INPUT X Z$;
CARDS;
101 PPP
101 QQQ
102 RRR
102 SSS
103 TTT
;
RUN;

DATA ONE_TO_MANY;
MERGE ONE TWO;
BY X;
RUN;
PROC PRINT;
RUN;

DATA THREE;
INPUT X Y$;
CARDS;
101 AA
101 BB
102 CC
102 DD
103 EE
;
RUN;

DATA MANY_TO_MANY;
MERGE  TWO THREE;
BY X;
RUN;
PROC PRINT;
RUN;

/*MERGE TWO DATASET WITH DIFFERENT VARIABLE NAME*/
DATA PART1;
INPUT EMPID NAME$;
CARDS;
101 SACHIN
105 LATA
103 SAINA
107 RAINA
;
RUN;

DATA PART2;
INPUT ID AGE SEX$;
CARDS;
102 28 M
105 29 F
107 30 M
109 29 F
103 31 F
;
RUN;

PROC SORT DATA=PART1;
BY EMPID;
PROC SORT DATA=PART2;
BY ID;
RUN;

DATA RESULT;
MERGE PART1 PART2(RENAME=(ID=EMPID));
BY EMPID;
RUN;
PROC PRINT;
RUN;

/*MERGE TWO DATASET WITH DIFFERENT VARIABLE DATA TYPE*/

DATA PART1;
INPUT ID$ NAME$;
CARDS;
101 SACHIN
105 LATA
103 SAINA
107 RAINA
;
RUN;

DATA PART2;
INPUT ID AGE SEX$;
CARDS;
102 28 M
105 29 F
107 30 M
109 29 F
103 31 F
;
RUN;


DATA PART1N;
SET PART1(RENAME=(ID=CHAR_ID));
ID=INPUT(CHAR_ID,8.);
DROP CHAR_ID;
RUN;

PROC SORT DATA=PART1N;
BY ID;
PROC SORT DATA=PART2;
BY ID;
RUN;

DATA RESULT2;
MERGE PART1N PART2;
BY ID;
RUN;

PROC PRINT;
RUN;

DATA PRICE_LIST;
INPUT ID$ NAME$ PRICE DOLLAR3.;
CARDS;
F101 SUGAR $32
F102 MILK $26
F103 TEA $86
F104 BREAD $20
;
RUN;
PROC PRINT;
RUN;

DATA NEW_PRICE_LIST;
INPUT ID$ NEWPRICE DOLLAR3.;
CARDS;
F102 $30
F104 $23
;
RUN;
PROC PRINT;
RUN;

DATA PRICE_LIST1;
UPDATE PRICE_LIST NEW_PRICE_LIST;
BY ID;
RUN;
PROC PRINT DATA=PRICE_LIST1;
RUN;

DATA PRICE_LIST1;
MERGE PRICE_LIST NEW_PRICE_LIST;
BY ID;
RUN;
PROC PRINT DATA=PRICE_LIST1;
RUN;




